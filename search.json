[
  {
    "objectID": "02_geostat.html#sources",
    "href": "02_geostat.html#sources",
    "title": "Géostatistique",
    "section": "Sources",
    "text": "Sources\nCe cours est construit principalement à partir de celui de Lilane Bel et du livre de Gaetan, Guyon, et al. (2010)"
  },
  {
    "objectID": "02_geostat.html#exemple-illustratif",
    "href": "02_geostat.html#exemple-illustratif",
    "title": "Géostatistique",
    "section": "Exemple illustratif",
    "text": "Exemple illustratif\nLa température en France"
  },
  {
    "objectID": "02_geostat.html#géostatistique",
    "href": "02_geostat.html#géostatistique",
    "title": "Géostatistique",
    "section": "Géostatistique",
    "text": "Géostatistique\n\n\nDomaine continu : \\(D \\subset \\mathbb{R}^2\\).\nProcessus stochastique : \\(Z = \\{Z(s)\\}_{s \\in D}\\)\n\nCollection de variables aléatoires indexées par \\(s \\in D\\).\nDonnées \\(Z(s_1), Z(s_2), \\ldots, Z(s_n)\\) observés.\n\n\nObjectifs :\n\nPrédiction \\(\\widehat{Z}(s_0)\\) de \\(Z(s_0)\\) ou intégrale \\(\\int_B Z(s)ds\\).\nEstimation de la loi de \\(Z(s)\\) ou d’une fonctionnelle \\(\\varphi(Z(s))\\).\nEstimation des relations de dépendance entre \\(Z(s_i)\\)."
  },
  {
    "objectID": "02_geostat.html#intuition",
    "href": "02_geostat.html#intuition",
    "title": "Géostatistique",
    "section": "Intuition",
    "text": "Intuition\n\nQue veut on prendre en compte ?\nQuid des répétitions ?\nQue peut-on espérer estimer, comprendre ?"
  },
  {
    "objectID": "02_geostat.html#estimation-de-la-moyenne",
    "href": "02_geostat.html#estimation-de-la-moyenne",
    "title": "Géostatistique",
    "section": "Estimation de la moyenne",
    "text": "Estimation de la moyenne\nHypothèses\n\n\\(E(Z(s)) = \\mu \\quad \\forall s \\in D\\)\n\\(\\text{cov}(Z(s_i), Z(s_j)) = c_{ij}\\)\n\nEstimation\n\nObservations : \\(Z(s_1), Z(s_2), \\ldots, Z(s_n)\\).\nEstimation de \\(E(Z(s)) = \\mu\\) ?\n\nContraintes\n\nEstimateur linéaire : \\(\\widehat{\\mu} = \\sum_{i=1}^n \\lambda_i Z(s_i)\\).\nSans biais : \\(\\text{E}(\\widehat{\\mu}) = \\mu\\).\nVariance minimale : \\(\\text{Var}(\\widehat{\\mu} - \\mu)\\)."
  },
  {
    "objectID": "02_geostat.html#estimation-de-la-moyenne-1",
    "href": "02_geostat.html#estimation-de-la-moyenne-1",
    "title": "Géostatistique",
    "section": "Estimation de la moyenne",
    "text": "Estimation de la moyenne\n\nSi \\(\\widehat{\\mu}\\) est sans biais alors\nQuelle est la conséquence de l’hypothèse de variance minimale ?"
  },
  {
    "objectID": "02_geostat.html#solution-best-linear-unbiased-estimator-blue",
    "href": "02_geostat.html#solution-best-linear-unbiased-estimator-blue",
    "title": "Géostatistique",
    "section": "Solution : Best Linear Unbiased Estimator (BLUE)",
    "text": "Solution : Best Linear Unbiased Estimator (BLUE)\n\nMinimisation : \\[\\min \\sum_{i,j=1}^n \\lambda_i \\lambda_j c_{ij} \\quad ; \\quad \\sum_{i=1}^n \\lambda_i = 1\\]\n\nUtiliser la méthode du multiplicateur de Lagrange et montrer qu’on cherche à résoudre le système linéaire\n\\[\\begin{pmatrix}\n  c_{11} & c_{12} & \\dots & c_{1n} & 1 \\\\\n  c_{21} & c_{22} & \\dots & c_{2n} & 1 \\\\\n  \\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n  c_{n1} & c_{n2} & \\dots & c_{nn} & 1 \\\\\n  1 & 1 & \\dots & 1 & 0\n  \\end{pmatrix}\n  \\begin{pmatrix}\n  \\lambda_1 \\\\\n  \\lambda_2 \\\\\n  \\vdots \\\\\n  \\lambda_n \\\\\n  m\n  \\end{pmatrix} =\n  \\begin{pmatrix}\n  0 \\\\\n  0 \\\\\n  \\vdots \\\\\n  0 \\\\\n  1\n  \\end{pmatrix}\\]\nConclusion si \\(c_{ij}\\) connus, on peut estimer la moyenne\nEncore faut il pouvoir estimer la covariance"
  },
  {
    "objectID": "02_geostat.html#spécificité-des-données-spatiales",
    "href": "02_geostat.html#spécificité-des-données-spatiales",
    "title": "Géostatistique",
    "section": "Spécificité des données spatiales",
    "text": "Spécificité des données spatiales\n\non a souvent une seule réalisation du processus spatial\nIl faut avoir des hypothèses de régularité spatial pour espérer dire des choses à partir d’une réalisation"
  },
  {
    "objectID": "02_geostat.html#définitions",
    "href": "02_geostat.html#définitions",
    "title": "Géostatistique",
    "section": "Définitions",
    "text": "Définitions\n\n\\(Z\\) est un processus du second ordre si \\(\\forall s \\in D, \\text{E}(Z(s)^2) &lt; \\infty\\).\nLa moyenne de \\(Z\\) est la fonction \\[\\begin{align}\n  m : D & \\to {\\mathbb{R}}\\\\\n    s & \\to m(s) = {\\mathbb{E}}(Z(s)))\n\\end{align}\\]\nLa covariance de \\(Z\\) est la fonction \\[\\begin{align}\n  c : D\\times D & \\to {\\mathbb{R}}\\\\\n    (s,t) & \\to c(s,t) = {\\mathbb{C}\\text{ov}}(Z(s), Z(t))\n\\end{align}\\]\n\nPropriété Une fonction de covariance est semi définie positive i.e.\n\\[\\forall a\\in {\\mathbb{R}}^n, \\sum_{i,j}^n a_i a_j C(s_i, s_j)\\geq 0\\] Idée de preuve : Regarder \\({\\mathbb{V}\\text{ar}}(\\sum_{i=1}^n a_i Z(s_i))\\)\n\n\\(Z\\) est un processus gaussien si pour toute partie finie \\(S \\subset D\\) et toute suite réelle \\(a = (a_s , s\\in S)\\), \\(\\sum_{s\\in S} a_s Z(s)\\) est une variable gaussienne."
  },
  {
    "objectID": "02_geostat.html#processus-stationnaire",
    "href": "02_geostat.html#processus-stationnaire",
    "title": "Géostatistique",
    "section": "Processus stationnaire",
    "text": "Processus stationnaire\nDéfinition\nUn processus de second ordre \\(Z\\) est stationnaire sur \\(D\\subset {\\mathbb{R}}^d\\) si\n\nMoyenne constante : \\(\\forall s\\in D, \\quad m(s) = \\mu\\).\nCovariance invariante par translation : \\[\\forall (s, t)\\in D^2\nc(s,t) = C(t - s) \\quad \\text{ou} \\forall h; s+h \\in D,  \\quad c(s,s+h) = C(h)\n\\]\n\nIsotropie\nUn processus est isotrope si \\(C(h)\\) dépend uniquement de \\(\\|h\\|\\) i.e \\[C(h) = C(\\|h\\|)\\]"
  },
  {
    "objectID": "02_geostat.html#stationarité-des-accroissements",
    "href": "02_geostat.html#stationarité-des-accroissements",
    "title": "Géostatistique",
    "section": "Stationarité des accroissements",
    "text": "Stationarité des accroissements\n\\(Z\\) est un processus à accroissements stationnaires si les accroissements de \\(Z\\) sont stationnaires au second ordre, i.e. \\[{\\mathbb{E}}(Z(s + h) − Z(s)) = 0\\] \\[{\\mathbb{V}\\text{ar}}(Z(s + h) − Z(s)) = 2\\gamma(h)\\] La stationnarité du second ordre implique la stationnarité des accroissements.\nLa classe des processus à accroissement stations est donc plus ….. que la classe des processus de second ordre. ### Exemple\nQue dire du mouvement Brownien sur \\({\\mathbb{R}}\\)"
  },
  {
    "objectID": "02_geostat.html#définition-1",
    "href": "02_geostat.html#définition-1",
    "title": "Géostatistique",
    "section": "Définition",
    "text": "Définition\nLe semi-variogramme d’un processus à accroissements stattionnaire est défini comme : \\[\\gamma(h) = \\frac{1}{2} {\\mathbb{V}\\text{ar}}(Z(s+h) - Z(s))\\]\nPropriétés\n\n\\(\\gamma(h) \\geq 0\\), \\(\\gamma(0) = 0\\), \\(\\gamma(-h) = \\gamma(h)\\).\nSi \\(Z\\) est stationnaire de second ordre : \\[\\gamma(h) = C(0) - C(h)\\]\nsi \\(lim_{|h|\\to \\infty} \\gamma(h) = \\ell &lt; +\\infty\\) alors le processus est stationnaire du second ordre et \\(\\ell = C(0)\\)"
  },
  {
    "objectID": "02_geostat.html#variogrammes-classiques",
    "href": "02_geostat.html#variogrammes-classiques",
    "title": "Géostatistique",
    "section": "Variogrammes classiques",
    "text": "Variogrammes classiques\n\nPépitique : \\(\\gamma(h) = C\\)\nExponentiel : \\(\\gamma(h) = C(1 - \\exp(-\\|h\\|/\\rho))\\).\nSphérique : \\[\\gamma(h) = \\begin{cases}\nC \\left( \\frac{3}{2} \\frac{\\|h\\|}{\\rho} - \\frac{1}{2} \\left(\\frac{\\|h\\|}{\\rho}\\right)^3 \\right) & \\text{si } \\|h\\| \\leq \\rho \\\\\nC & \\text{si } \\|h\\| &gt; \\rho\n\\end{cases}\\]\nGaussien : \\(\\gamma(h) = C(1 - \\exp(-\\|h\\|^2/\\rho))\\).\nPuissance : \\(\\gamma(h) =  C\\left | h\\right|^\\alpha,  \\alpha &lt; 2\\)"
  },
  {
    "objectID": "02_geostat.html#un-variogramme-particulier",
    "href": "02_geostat.html#un-variogramme-particulier",
    "title": "Géostatistique",
    "section": "Un variogramme particulier",
    "text": "Un variogramme particulier\nClasse de Matèrn\n\\[ \\gamma(h) = C\\left [ 1 - \\frac{1}{2^{\\nu -1}\\Gamma(\\nu)}\\left(\\frac{\\sqrt{2\\nu }h}{\\rho}\\right)K_{\\nu}\\left(\\frac{\\sqrt{2\\nu }h}{\\rho}\\right)\\right]\\] \\(K_{\\nu}\\) fonction de Bessel modifiée de 3ème espèce, d’ordre \\(\\nu\\)\n\\(\\nu\\) paramètre qui règle la régularité en 0.\n\n\\(\\nu\\) = 1/2 : modèle exponentiel\n\\(\\nu\\to \\infty\\)"
  },
  {
    "objectID": "02_geostat.html#effet-des-paramètres",
    "href": "02_geostat.html#effet-des-paramètres",
    "title": "Géostatistique",
    "section": "Effet des paramètres",
    "text": "Effet des paramètres\n\npalier \\(C = \\lim_{h \\to \\infty} \\gamma(h)\\)}\néchelle \\(\\rho\\)\nportée \\(\\widetilde{\\rho} \\mbox{ t.q. } \\|h\\| \\ge \\widetilde{\\rho} \\rightarrow C - \\gamma(h) \\le \\varepsilon\\)\npépite \\(\\tau = \\lim_{h \\to 0} \\gamma(h)\\)"
  },
  {
    "objectID": "02_geostat.html#effet-des-paramètres-1",
    "href": "02_geostat.html#effet-des-paramètres-1",
    "title": "Géostatistique",
    "section": "Effet des paramètres",
    "text": "Effet des paramètres\n\nLe palier : S’il est fini, le processus \\(Z\\) est stationnaire du second ordre et \\[ C = \\mbox{Var}(Z(s))\\]\nL’échelle : Règle la vitesse à laquelle le variogramme rejoint le palier. Donne une idée de l’horizon de dépendance du processus.\nLa portée est la distance à partir de laquelle la corrélation est nulle ou négligeable\nLa pépite donne la régularité du processus\n\nsi \\(\\tau\\neq 0\\) le processus est très irrégulier (bruit blanc, erreur de mesure)\nsi \\(\\tau=0\\), la régularité du variogramme en 0 (paramètre \\(\\nu\\) dans le variogramme de Matern)"
  },
  {
    "objectID": "02_geostat.html#intuition-1",
    "href": "02_geostat.html#intuition-1",
    "title": "Géostatistique",
    "section": "Intuition",
    "text": "Intuition\n\nQuelles données pour le variogramme\nComment peut-on s’y prendre"
  },
  {
    "objectID": "02_geostat.html#nuée-variographique",
    "href": "02_geostat.html#nuée-variographique",
    "title": "Géostatistique",
    "section": "Nuée Variographique",
    "text": "Nuée Variographique\n\\[\\gamma(h) =\\frac{1}{2} {\\mathbb{V}\\text{ar}}(Z(s+h) - Z(s)) = \\frac{1}{2} {\\mathbb{E}}( (Z(s+h) - Z(s))^2 )\\]\nOn cherche donc à associer à chaque \\(h\\), \\(0.5 {\\mathbb{E}}( (Z(s+h) - Z(s))^2 )\\), on va approcher cette espérance par \\(0.5 \\left (Z(s_i)- Z(s_j) \\right)^2\\)\n\ntemp_df &lt;- temp_df |&gt; st_transform(crs = \"EPSG:2154\" )\nvario.cloud = variogram(temp_moy~1, data = temp_df, cloud = TRUE)\nvario.cloud |&gt; ggplot(aes(x=dist, y =gamma)) + geom_point() + ggtitle(\"Nuée variographique\")"
  },
  {
    "objectID": "02_geostat.html#variogramme-expérimental",
    "href": "02_geostat.html#variogramme-expérimental",
    "title": "Géostatistique",
    "section": "Variogramme expérimental",
    "text": "Variogramme expérimental\n\\[\\widetilde \\gamma (d_k) = \\frac{1}{2n_c}\\sum_{(k-1)\\delta \\le \\|s_i-s_j\\| \\le k\\delta}(Z(s_i)-Z(s_j))^2 \\]\n\nvario.b = variogram(temp_moy~1, data = temp_df\n                    # , alpha=c(0,45,90,135)\n                    )\nggplot(data = vario.b, aes(x=dist, y =gamma)) + facet_wrap(~dir.hor) + geom_point() + ylim(c(0, 28))"
  },
  {
    "objectID": "02_geostat.html#propriétés-du-variogramme-expérimental",
    "href": "02_geostat.html#propriétés-du-variogramme-expérimental",
    "title": "Géostatistique",
    "section": "Propriétés du variogramme expérimental",
    "text": "Propriétés du variogramme expérimental\n* sans biais,\n* sous des conditions de mélange, loi limite gaussienne, $\\quad$ variance en $\\frac{1}{n}$,\n* ne nécessite pas l'estimation de la moyenne, \n* si $Z$ est gaussien, somme de $\\chi^2(1)$\nEstimateur robuste\n\\[\\widetilde \\gamma (d_k) = \\left\\{\\frac{1}{2n_c}\\sum_{i,j \\in C(k)}(Z(s_i)-Z(s_j))^2\\right\\}^{1/4}\\frac{1}{0.457 + \\frac{0.494}{n_c}}\\]"
  },
  {
    "objectID": "02_geostat.html#ajustement-du-variogramme",
    "href": "02_geostat.html#ajustement-du-variogramme",
    "title": "Géostatistique",
    "section": "Ajustement du variogramme",
    "text": "Ajustement du variogramme\n\\(\\gamma_{\\rho,C,\\nu,\\tau}\\) variogramme admissible, \\((\\rho,\\nu, C, \\tau)\\) solution du problème \\[\\min_{\\rho,C,\\nu,\\tau} \\sum_{k=1}^K (\\gamma_{\\rho,C,\\nu,\\tau}(d_k) - \\widetilde \\gamma(d_k))^2\\]\nAutres méthodes possibles : max de vraisemblance, moindres carrés généralisés"
  },
  {
    "objectID": "02_geostat.html#objectif",
    "href": "02_geostat.html#objectif",
    "title": "Géostatistique",
    "section": "Objectif",
    "text": "Objectif\nOn observe \\(z(s_1),z(s_2),\\ldots,z(s_n)\\)} aux sites \\(s_1,s_2,\\ldots,s_n\\) et on veut prédire \\(g(Z(s))\\), \\(s\\in D\\)\nPar exemple\n\n\\(Z(s_0)\\), \\(s_0\\) non observé,\n\\(\\frac{1}{|B|}\\int_B Z(s)ds \\quad B \\mbox{ région de } D\\)},\n\\(P(Z(s_0)&gt;\\zeta)\\)"
  },
  {
    "objectID": "02_geostat.html#prédicteur-optimal",
    "href": "02_geostat.html#prédicteur-optimal",
    "title": "Géostatistique",
    "section": "Prédicteur optimal",
    "text": "Prédicteur optimal\nPrédire \\(Z(s_0)\\) sachant \\(Z(s_1)=z(s_1),\\ldots,Z(s_n)=z(s_n)\\)\nPrédicteur optimal\nPar la propriété de l’espérance conditionnelle, le prédicteur optimal est\n\\[p^{opt}_{s_0}(Z(s_1),\\ldots,Z(s_n)) = \\mbox{E}\\big(Z(s_0)/Z(s_1),\\ldots,Z(s_n)\\big) \\] puisqu’il minimise le risque quadratique \\[\\mbox{E}\\big((Z(s_0)-\\widehat{Z}(s_0))^2\\big)\\] Prédicteur linéaire optimal (BLUP) \\[ p^* = \\alpha + \\sum_{i=1}^n\\lambda_i Z(s_i)\\] Si \\(Z\\) gaussien, \\(p^{opt}=p^*\\)\nSolution\n\\[\\begin{align}\n\\lambda &= C^{-1}c \\qquad C_{i,j} = \\mbox{cov}\\big(Z(s_i),Z(s_j)\\big)\n                 \\quad c_i = \\mbox{cov}\\big(Z(s_0),Z(s_i)\\big)\\\\\n     \\alpha  = & \\mbox{E}(Z(s_0)) - \\sum_{i=1}^n\\lambda_i \\mbox{E}(Z(s_i))\n\\end{align}\\]"
  },
  {
    "objectID": "02_geostat.html#krigeage-simple",
    "href": "02_geostat.html#krigeage-simple",
    "title": "Géostatistique",
    "section": "Krigeage simple",
    "text": "Krigeage simple\nSupposons \\(C\\) et \\(m(s)\\) connues \\[\\widehat{Z(s_0)} = \\; c^T C^{-1}(Z-m) + m(s_0)\\] Variance de krigeage \\[\\sigma^2_{SK} = \\sigma^2(s_0) - c^TC^{-1}c\\] Si \\(s_0=s_i\\), alors \\[\\widehat{Z(s_i)}=Z(s_i)\\]\nIl faut estimer \\(C\\) et \\(m(s)\\)."
  },
  {
    "objectID": "02_geostat.html#krigeage-universel",
    "href": "02_geostat.html#krigeage-universel",
    "title": "Géostatistique",
    "section": "Krigeage universel",
    "text": "Krigeage universel\nHypothèses : \\(Z(s) = X\\beta + \\epsilon(s)\\),\nOn cherche \\(\\widehat{Z}(s_0) = \\sum_{i=1}^n\\lambda_iZ(s_i)\\)} avec \\[E(\\widehat{Z}(s_0)) = E(Z(s_0)) \\mbox{ et }  E(\\widehat{Z}(s_0) - Z(s_0))^2 \\mbox{ minimum}\\]\nCovariance : \\(C(h) = Cov(Z(s+h),Z(s))\\), \\(\\boldsymbol{\\Sigma}\\) the covariance matrix (\\(\\Sigma_{ij}= C(s_j-s_i)\\)), \\(\\boldsymbol{c_0}\\) the covariance vector (\\(c_j =C(s_o-s_j)\\))\nProposition :\n\\[\\widehat{Z}(s_0) = \\left \\lbrace \\boldsymbol{c_0}^T \\boldsymbol{\\Sigma}^{-1} + (X_0 - X^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{c_0})^T (X^T \\boldsymbol{\\Sigma}^{-1} X)^{-1} X^T  \\boldsymbol{\\Sigma}^{-1}  \\right\\rbrace Z\\] \\[\n\\tau^2(s_0) = \\sigma_0^2 -  \\mathbf{c_0}^T \\mathbf{\\Sigma}^{-1} \\mathbf{c_0}\n+  \\left( X_0 -  \\mathbf{X}^T \\mathbf{\\Sigma}^{-1} \\mathbf{c_0} \\right)^T\n\\left(  \\mathbf{X}^T \\mathbf{\\Sigma}^{-1} \\mathbf{X} \\right)^{-1}\n\\left( X_0 -  \\mathbf{X}^T \\mathbf{\\Sigma}^{-1} \\mathbf{c_0} \\right)\\] \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRemarques\n\nOn n’a pas forcément \\(0 \\le \\lambda_i \\le 1\\)\nSi \\(s_0 \\in \\{ s_1,\\ldots s_n\\}\\) alors \\(\\lambda_i = 1\\), \\(\\lambda_j=0\\), \\(j\\neq i\\)}, et \\(\\sigma_K^2(s_i)=0\\)\nles poids de krigeage \\(\\lambda_i\\) dépendent de la disposition des sites de données, de la localisation du site de prédiction, du nombre de données et de la fonction variogramme."
  },
  {
    "objectID": "02_geostat.html#en-pratique",
    "href": "02_geostat.html#en-pratique",
    "title": "Géostatistique",
    "section": "En pratique",
    "text": "En pratique\nVoir le TD"
  },
  {
    "objectID": "02_geostat.html#références",
    "href": "02_geostat.html#références",
    "title": "Géostatistique",
    "section": "Références",
    "text": "Références\n\n\n\n\n\n\n\n\nGaetan, Carlo, Xavier Guyon, et al. 2010. Spatial Statistics and Modeling. Vol. 90. Springer."
  },
  {
    "objectID": "01_intro.html#cadre",
    "href": "01_intro.html#cadre",
    "title": "Introduction",
    "section": "Cadre",
    "text": "Cadre\n{La statistique spatiale}[.rouge] est une branche de la statistique qui se concentre sur l’analyse et la modélisation de données localisées géographiquement ou spatialement.\nElle prend en compte la localisation des observations et les relations spatiales entre elles, notamment elle permet de lier la dépendance et la localisation spatiale.\nPour quelles applications ?\n\nSciences de la terre : position des séismes.\nEnvironnement : température, pluie\nEpdémiologie : nombre de cander par régions administratives\nEcologie : localisation des différents arbre d’une espeèce au sein d’une parcelle,\nAgrnomie : répartition des pucerons dans une parcelle cultivée\nEconomie spatiale : taux de chomage par région administrative, prix au m2 des appartements au sein d’une ville\nImagerie : Couleur d’un pixel en fonction de sa localisation sur l’image"
  },
  {
    "objectID": "01_intro.html#données-géostatistiques",
    "href": "01_intro.html#données-géostatistiques",
    "title": "Introduction",
    "section": "1. Données géostatistiques",
    "text": "1. Données géostatistiques\nDescription\n\nObservation : A un point \\(s\\) d’un domaine spatial \\(D\\), on associe une valeur observée \\(Z(s)\\). La grandeur mesurée est définie partout mais on l’observe seulement en \\(n\\) points \\(s_1, \\ldots, s_n\\).\nCaractéristiques :\n\nPositions continues.\nGénéralement irrégulièrement espacées.\nModèles courants : modèles de champs spatiaux\n\nExemples : Porosité du sol, concentrations de polluants.Températures mesurées à des stations météo,\n\nVisualisation\n\nCarte avec des points représentant les positions des observations.\n\nObjectifs\n\nModélisation.\nSéparation des variations à différentes échelles.\nPrédiction (krigeage)."
  },
  {
    "objectID": "01_intro.html#exemple-de-données-géostatistiques",
    "href": "01_intro.html#exemple-de-données-géostatistiques",
    "title": "Introduction",
    "section": "1. Exemple de données géostatistiques",
    "text": "1. Exemple de données géostatistiques"
  },
  {
    "objectID": "01_intro.html#données-en-réseau-ou-maillage-fixe-données-lattice",
    "href": "01_intro.html#données-en-réseau-ou-maillage-fixe-données-lattice",
    "title": "Introduction",
    "section": "2. Données en réseau ou maillage fixe (données lattice)",
    "text": "2. Données en réseau ou maillage fixe (données lattice)\n\nObservation : pour un réseau donné, on associe à chaque maille \\(i\\) du réseau une valeur \\(Z_i\\). La grandeur mesurée est définie pour l’ensemble de la maille, elle ne varie pas continuement. Les données sont donc agrégées sur des zones géographiques définies (polygones).\nExemples :\n\nPourcentage de groupe sanguin par région.\nPrix au m2 par arrondissement à Paris.\nPixels dans une image.\n\n\nVisualisation\n\nCartes choroplèthes.\n\nObjectifs\n\nExplicatifs (lien avec des covariables)\nAnalyse des corrélations spatiales.\nRestauration d’images."
  },
  {
    "objectID": "01_intro.html#exemple-de-données-lattice",
    "href": "01_intro.html#exemple-de-données-lattice",
    "title": "Introduction",
    "section": "2. Exemple de données lattice",
    "text": "2. Exemple de données lattice\n\n\nFigure 1"
  },
  {
    "objectID": "01_intro.html#données-ponctuelles",
    "href": "01_intro.html#données-ponctuelles",
    "title": "Introduction",
    "section": "3. Données ponctuelles",
    "text": "3. Données ponctuelles\n\nObservations on note la présence d’un évènement en la position \\(s\\). \\(s_i\\) est donc la position du ième évènement d’intérêt\nExemples : Positions des chênes dans une forêt, position des épicentres de séismes\n\nVisualisation\n\nCarte de points.\n\nObjectifs\n\nRégularité.\nDistribution aléatoire (Poisson).\nAgrégation."
  },
  {
    "objectID": "01_intro.html#exemple-de-données-ponctuelles",
    "href": "01_intro.html#exemple-de-données-ponctuelles",
    "title": "Introduction",
    "section": "3. Exemple de données ponctuelles",
    "text": "3. Exemple de données ponctuelles\nFigure extraite de Renner et al. (2015)\n\n\nFigure 2"
  },
  {
    "objectID": "01_intro.html#exercice",
    "href": "01_intro.html#exercice",
    "title": "Introduction",
    "section": "Exercice",
    "text": "Exercice\n\nSciences de la terre : position des séismes.\nEnvironnement : température, pluie\nEpdémiologie : nombre de cander par régions administratives\nEcologie : localisation des différents arbre d’une espeèce au sein d’une parcelle,\nAgrnomie : répartition des pucerons dans une parcelle cultivée\nEconomie spatiale : taux de chomage par région administrative, prix au m2 des appartements au sein d’une ville\nSociologie : Localisation des crimes, des stations de service.\nImagerie : Couleur d’un pixel en fonction de sa localisation sur l’image"
  },
  {
    "objectID": "01_intro.html#cadre-du-cours",
    "href": "01_intro.html#cadre-du-cours",
    "title": "Introduction",
    "section": "Cadre du cours",
    "text": "Cadre du cours\nLa statistique spatiale analyse des données localisées dans l’espace.\nCes données se classent en trois grandes catégories, nous étudierons les deux premières dans ce cours.\n\nChamps spatiaux observés en quelques positions\nValeurs associées à des régions (données lattice)\nÉvénements géolocalisés (processus ponctuels)"
  },
  {
    "objectID": "01_intro.html#references",
    "href": "01_intro.html#references",
    "title": "Introduction",
    "section": "References",
    "text": "References\n\n\nRenner, Ian W, Jane Elith, Adrian Baddeley, William Fithian, Trevor Hastie, Steven J Phillips, Gordana Popovic, and David I Warton. 2015. “Point Process Models for Presence-Only Analysis.” Methods in Ecology and Evolution 6 (4): 366–79."
  },
  {
    "objectID": "01_pluies.html",
    "href": "01_pluies.html",
    "title": "TD1 - Statistique Spatiale",
    "section": "",
    "text": "Ce premier TD vise à explorer les données spatialisées de précipitations en Suisse. Nous utiliserons R et plusieurs packages spécialisés (tidyverse, sf, gstat, etc.) pour visualiser, analyser et modéliser ces données.\nUtilisez les clusters cluster10 et cluster13"
  },
  {
    "objectID": "01_pluies.html#présentation",
    "href": "01_pluies.html#présentation",
    "title": "TD1 - Statistique Spatiale",
    "section": "",
    "text": "Ce premier TD vise à explorer les données spatialisées de précipitations en Suisse. Nous utiliserons R et plusieurs packages spécialisés (tidyverse, sf, gstat, etc.) pour visualiser, analyser et modéliser ces données.\nUtilisez les clusters cluster10 et cluster13"
  },
  {
    "objectID": "01_pluies.html#objectifs",
    "href": "01_pluies.html#objectifs",
    "title": "TD1 - Statistique Spatiale",
    "section": "Objectifs",
    "text": "Objectifs\n\nCharger et visualiser les données spatialisées.\nConstruire et interpréter des nuées variographiques.\nEstimer et ajuster des variogrammes.\nEffectuer un krigeage pour interpoler les précipitations.\nTester différentes structures de variogramme et intégrer une covariable."
  },
  {
    "objectID": "01_pluies.html#directives",
    "href": "01_pluies.html#directives",
    "title": "TD1 - Statistique Spatiale",
    "section": "Directives",
    "text": "Directives\n\n1. Chargement et visualisation des données\nlibrary(tidyverse)\nlibrary(ggforce)\nlibrary(gstat)\nlibrary(sf)\n\n\ndta_full_sf &lt;- st_read(dsn = \"swiss_full/swiss_rain_full.shp\") \ndta_sf &lt;- st_read(dsn = \"swiss/swiss_rain.shp\")\nbords_sf &lt;- st_read(dsn = \"swiss/bords.shp\") \nelev_sf &lt;- st_read(dsn = \"swiss/elev.shp\") \n\ndta_sf |&gt; st_coordinates() |&gt; bind_cols(dta_sf) |&gt; ggplot() + \n    geom_sf(data = bords_sf, linewidth = 0.1) +\n    geom_circle(aes(x0=X, y0=Y, r=pluies/100, fill = pluies)) +\n    scale_fill_viridis_c(name = \"Pluies\", option = \"mako\", direction = -1) \n\n\ndta_full_sf |&gt; st_coordinates() |&gt; bind_cols(dta_full_sf) |&gt; \n    ggplot() + \n    geom_sf(data = bords_sf, linewidth = 0.1) +\n    geom_circle(aes(x0=X, y0=Y, r=pluies/100, fill = pluies)) +\n    scale_fill_viridis_c(name = \"Pluies\", option = \"mako\", direction = -1) \n\nelev_sf |&gt; ggplot() + \n    geom_sf(aes(col = elevation)) + \n    geom_sf(data = bords_sf, fill = NA, linewidth = 1.5) + \n    theme_minimal() +\n    theme(legend.position = \"right\") +\n    scale_color_viridis_c(name = \"Z\", option = \"mako\", transform= \"log10\")\n\n\n2. Nuées variographiques à la main\nnuees_dta &lt;- do.call(rbind, lapply(1:nrow(dta_sf), function(i) {\n    xy &lt;- st_coordinates(dta_sf)\n    x0 &lt;- xy[i, 1]\n    y0 &lt;- xy[i, 2]\n    pluie0 &lt;- dta_sf$pluies[i]\n    dta_sf |&gt; rownames_to_column('Id')  |&gt; \n        mutate(delta_x = xy[,1] - x0, delta_y = xy[,2] - y0, ecart = pluies - pluie0) |&gt; \n        filter(Id &gt; i) |&gt; \n        mutate(h = sqrt(delta_x^2 + delta_y^2), ecart2 = ecart^2 / 2) |&gt; \n        select(Id, h, ecart2)\n}))\n\nnuees_dta |&gt; ggplot() + geom_point(aes(x=h, y=ecart2)) + xlim(c(0, 120000))\n\n\n3. Variogramme empirique\nvario.cloud &lt;- variogram(pluies~1, data = dta_sf, cloud = TRUE)\nvario.cloud |&gt; ggplot(aes(x=dist, y=gamma)) + geom_point() + ggtitle(\"Nuée variographique\")\n\n\n4. Ajustement du variogramme\nvario.iso &lt;- variogram(pluies~1, data = dta_sf)\nv.fit &lt;- fit.variogram(vario.iso, vgm(model = \"Exp\", 15000, 60))\nvario_fit_exp &lt;- variogramLine(v.fit, maxdist = 120)\n\nggplot(data = vario.iso, aes(x=dist, y=gamma)) + \n    geom_point() + geom_line(data= vario_fit_exp , aes(x=dist, y=gamma))\n\n\n5. Krigeage\nKfull &lt;- krige(formula = pluies ~ 1, locations = dta_sf, newdata = dta_full_sf, model = v.fit)\nKfull |&gt; ggplot() + geom_sf(aes(fill = var1.pred)) +\n    geom_sf(data = dta_sf, aes(col = pluies)) +\n    scale_fill_viridis_c(option = \"mako\", transform = \"log10\")\n\n\n6. À votre tour\n\nTester différentes formes de variogramme (exponentiel, gaussien, sphérique).\nAjouter une covariable (altitude) au modèle de krigeage et comparer les résultats."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Statistique Spatiale",
    "section": "",
    "text": "Description du cours\nCe cours présente des techniques statistiques pour représenter des données spatiales.La spécificité de celles-ci réside dans la structure de dépendance qui dépend d’une notion de proximité. On distingue différents type de données spatiales\n\ndes mesures sur un support continu\ndes mesures associées à des régions géographiques\ndes localisations d’évènement.\n\nCes différents types de données nécessites des représentations statistique différentes. De plus, les questions que l’on aborde avec ce type de données sont elles aussi assez spécifiques.\nS’agissant de mesure sur un support continu, on va souvent vouloir prédire une valeur en un site non observé, en fonction des observations. Ceci sera également souvent le cas lorsque l’on traite des données régionales. Lorsque l’on observe des positions d’vènements, on voudra le plus souvent comprendre la strure responsable de la répartition des points\n\n\nContenu\n\nGéostastique les méthodes classiques pour les mesures sur des supports continue\nDonnées sur réseaux pour représenter les données associées à des régions\nProcessus ponctuels pour modéliser les semis de points\n\nLe cours mettra un accent particulier sur la mise en oeuvre de ces méthodes sur des cas concrets.\nÀ la fin du cours, les étudiants seront compétents dans la modélisation classique des données spatiales.\n\n\nOrganisation du cours\n\n20h de Cours/TP"
  },
  {
    "objectID": "references_statspat.html",
    "href": "references_statspat.html",
    "title": "References",
    "section": "",
    "text": "liste &lt;- \n    readLines('spatstat.bib') |&gt; \n  as_tibble() |&gt; \n  filter(stringr::str_detect(value, pattern = '@|keywords')) |&gt; \n  rowid_to_column() %&gt;% \n  mutate(int_part = floor((rowid-1)/2), parity = rowid %% 2) %&gt;% \n  select(-rowid) %&gt;% \n  pivot_wider( values_from = value, names_from = parity, names_prefix = \"key\") |&gt; \n  mutate(key1 = stringr::str_remove(key1, pattern = '@[:alnum:]+\\\\{')) |&gt; \n  mutate(key1 = stringr::str_remove(key1, pattern = ',')) \n  \nstatspat_liste &lt;- liste %&gt;% \n  filter(str_detect(key0, 'spatstat')) %&gt;% \n  select(key1) %&gt;% \n  pull()\n\nNoCite(bib = myBib, statspat_liste)"
  },
  {
    "objectID": "references_statspat.html#pour-approfondir-ou-compléter-le-cours",
    "href": "references_statspat.html#pour-approfondir-ou-compléter-le-cours",
    "title": "References",
    "section": "Pour approfondir ou compléter le cours",
    "text": "Pour approfondir ou compléter le cours\nSpatial and spatio-temporal models with R-INLA (2013). “Spatial and spatio-temporal models with R-INLA”. In: Spatial and spatio-temporal epidemiology 4, pp. 33-49.\nBayesian inference with INLA (2020). Bayesian inference with INLA. Chapman and Hall/CRC.\nCressie, N. (2015). Statistics for spatial data. John Wiley & Sons.\nGaetan, C., X. Guyon, and others (2010). Vol. 90. Springer."
  }
]